<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <title>COVID-19 DIAGNOSTIC FORM</title>
</head>
<body class="bg-success-subtle">
    <div class="container bg-light" style="padding-left: 0; padding-right: 0;">

        <div class="h2 d-flex justify-content-center p-5 bg-success">
            COVID-19 DIAGNOSTIC FORM
        </div>

        <div class="col-6 d-flex justify-content-center p-3 border border-success rounded-3 m-auto">
            <form method="post" action="addusers.php">
                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                        <label class="p-2" for="fullname">Name:</label>
                        <input class="p-2" style="text-align: center;" type="text" id="name" name="fullname" placeholder="Enter your name" required >

                </div>

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                        <label class=" p-2" for="nationality">Nationality:</label>
                        <select class="col-sm-3 p-2" style="text-align: center;" name="nationality" id="nationality" required>
                            <option value="-1" selected disabled>Select One</option>
                            <option value="Filipino">Filipino</option>
                            <option value="Others">Others</option>
                        </select>
                </div>

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <label class="p-2" for="gender">Gender:</label>
                    <select class="p-2" style="text-align: center;" name="gender" id="gender" required>
                        <option value="-1" selected disabled>Select One</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">    
                    <label class="p-2" for="age">Age:</label>
                    <select class="p-2" style="text-align: center;" name="age" id="age" required>
                        <option value="-1" selected disabled>Select One</option>
                        <option value="0 - 1 yr old">0 - 1 yr old</option>
                        <option value="2 - 12 yrs old">2 - 12 yrs old</option>
                        <option value="13 - 17 yrs old">13 - 17 yrs old</option>
                        <option value="18+ yrs old">18+ yrs old</option>
                        <option value="65+ yrs old">65+ yrs old</option>
                    </select>
                </div>  

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <label class="p-2" for="mobile_no">Mobile No.:</label>
                    <input class="p-2" style="text-align: center;" type="tel" id="mobile_no" name="mobile_no" pattern="[+][0-9]{2}-[0-9]{10}" placeholder="+63-1234567890" required>
                </div>

                <div class="d-flex justify-content-left p-3">
                    <label class="p-2" for="body_temp">Body Temp:</label>
                    <input class="p-2" style="text-align: center;" type="number" id="body_temp" name="body_temp" placeholder="Enter your body temp in C" required>
                </div>

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <label class="p-2" for="diagnosed">COVID-19 DIAGNOSED:</label>
                    <select class="p-2" style="text-align: center;" name="diagnosed" id="diagnosed" required>
                        <option value="-1" selected disabled>Select One</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>                
                </div>    

                <div  class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <label class="p-2" for="encounter">COVID-19 Encounter:</label>
                    <select class="p-2" style="text-align: center;" name="encounter" id="encounter" required>
                        <option value="-1" selected disabled>Select One</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>
                </div>

                <div  class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <label class="p-2" for="vaccinated">COVID-19 Vaccinated:</label>
                    <select class="p-2" style="text-align: center;" name="vaccinated" id="vaccinated" required>
                        <option value="-1" selected disabled>Select One</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>
                </div>

                <div class="row d-flex justify-content-center p-3" style="text-align: center; font-size: x-large;">
                    <button class="btn btn-success" type="submit" id="submit" onclick="addGuest()">Save</button>
                </div>
            </form>
       
        </div>
        
        <div class="h2 d-flex justify-content-center p-5 bg-success mt-8" style="margin-bottom: 8;margin-top: 8px;">
            COVID-19 DIAGNOSTIC FORM
        </div>             
    
        <div class="row d-flex justify-content-center p-3">
            <a style="text-align: center;" href="admin.html" id="admin">Admin Page</a>
        </div>    
    
        <div id="tabular" class="col"></div>
    
    </div>
    
    <script>
        function addGuest()
        {
               $.ajax({
                   url: 'addusers.php',
                   method: "POST",
                   data: {			
                    fullname: $("#fullname").val(),
                    nationality: $("#nationality").val(),
                    gender: $("#gender").val(),
                    age: $("#age").val(),
                    mobile_no: $("#mobile_no").val(),
                    body_temp: $("#body_temp").val(),
                    diagnosed: $("#diagnosed").val(),
                    encounter: $("#encounter").val(),
                    vaccinated: $("#vaccinated").val()
                   },
                   dataType: "json",
                   success: function(result){
                     console.log(result);
                     if (result.status != 'ok')
                     {
                       alert("Something went wrong!");
                       return;
                     }
                     $("#tabular").html(cformtable());
                     getallguest();          
                   }
                 });
        }
 
 
        function cformtable()
   {
     /*
     name, gender, age, mobile no, body temp, covid-19 diagnosed(y/n), covid-19 encounter(y/n), 
     vacinated(y/n), nationality
     */
     return '<div class="card-body">' + 
           '<table id="tabentries" class="table table-bordered table-hover">' + 
              '<thead>' + 
                 '<tr>' + 
                    '<th> Name </th>' + 
                    '<th> Nationality </th>' + 
                    '<th> Gender </th>' + 
                    '<th> Age </th>' +
                    '<th> Mobile Number</th>' +
                    '<th> Body Temp Â°C </th>' +
                    '<th> COVID-19 Diagnosed </th>' +
                    '<th> COVID-19 Encounter </th>' +
                    '<th> Vaccinated </th>' +
                 '</tr>' + 
               '</thead>' + 
               '<tbody>' + 
               '</tbody>' + 
           '</table>' +
           '<br />' +
           '<div id="next"></div>' +
       '</div>';
   }
 
   function cformtablerow(par_row)
   {
     $("#tabentries  tbody").append(
              '<tr id="' + par_row.id + '">' + 
                '<td>' + par_row.fullname + '</td>' + 
                '<td>' + par_row.nationality + '</td>' + 
                '<td>' + par_row.gender +'</td>' +
                '<td>' + par_row.age + '</td>' +
                '<td>' + par_row.mobile_no + '</td>' +
                '<td>' + par_row.body_temp + '</td>' +
                '<td>' + par_row.diagnosed + '</td>' +
                '<td>' + par_row.encounter + '</td>' +
                '<td>' + par_row.vaccinated + '</td>' + 
                '</tr>'
     );
   }
 
        function getallguest()
        {
         //[{"id":"6","firstname":"Perlita","lastname":"Bayabas","email":"perlita.bayabas@mainit.com"},
         $.ajax({
                 url: 'getallguests.php',
                 method: "GET",
                 data: {},
                 dataType: "json",
                 success: function(response){
                   $.each(response, function(key, value){
                     cformtablerow({    
                                     id: value.id,
                                     fullname: value.fullname,
                                     nationality: value.nationality, 
                                     gender: value.gender,
                                     age: value.age,
                                     mobile_no: value.mobile_no,
                                     body_temp: value.body_temp,
                                     diagnosed: value.diagnosed,
                                     encounter: value.encounter,
                                     vaccinated: value.vaccinated,
                               }
                         );
                     
                   });
                 }		
                 
               });
        }
 
       function start()
       {
         $("#tabular").html(cformtable());
         getallguest();
       }
       start();
     </script>
</body>
</html>
